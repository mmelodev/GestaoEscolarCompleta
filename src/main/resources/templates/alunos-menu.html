<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <title>Alunos - AriranG</title>
    <link rel="stylesheet" th:href="@{/css/home.css?v=2.0}" />
    <link rel="stylesheet" th:href="@{/css/header.css?v=2.0}" />
    <link rel="stylesheet" th:href="@{/css/alunos-menu-styles.css?v=1.0}" />
</head>
<body>
<header>
    <div class="main-nav">
        <div class="logo">
            <a th:href="@{/}"><img th:src="@{/img/horizontal_negativa.png}" alt="Logo AriranG" /></a>
        </div>
        <nav>
            <!-- BotÃ£o HambÃºrguer - Mobile -->
            <button class="menu-toggle" id="menuToggle" aria-label="Abrir menu" aria-expanded="false" aria-controls="navList">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <ul class="nav-list" id="navList">
                <a th:href="@{/}"><li class="nav-element">Home</li></a>
                <a sec:authorize="hasAnyRole('ADMIN', 'USER')" th:href="@{/alunos/lista}"><li class="nav-element">Alunos</li></a>
                <a sec:authorize="hasAnyRole('ADMIN', 'USER')" th:href="@{/turmas}"><li class="nav-element">Turmas</li></a>
                <a sec:authorize="hasAnyRole('ADMIN', 'USER')" th:href="@{/contratos}"><li class="nav-element">Contratos</li></a>
                <a sec:authorize="hasAnyRole('ADMIN', 'USER')" th:href="@{/financeiro}"><li class="nav-element">Financeiro</li></a>
                <a sec:authorize="isAuthenticated()" th:href="@{/cadastro}"><li class="nav-element">Cadastro</li></a>
                <a sec:authorize="isAuthenticated()" th:href="@{/perfil}"><li class="nav-element">Meu Perfil</li></a>
                <a sec:authorize="isAuthenticated()" th:href="@{/configuracao}"><li class="nav-element">ðŸŽ¨ PersonalizaÃ§Ã£o</li></a>
                <li class="nav-element" sec:authorize="isAuthenticated()">
                    <form th:action="@{/logout}" method="post" class="nav-logout-form">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="logout-button" aria-label="Encerrar sessÃ£o">Sair</button>
                    </form>
                </li>
                <a sec:authorize="!isAuthenticated()" th:href="@{/login}"><li class="nav-element">Login</li></a>
            </ul>
            <div sec:authorize="isAuthenticated()" class="user-badge">
                <span class="user-badge__icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="8" r="4"></circle>
                        <path d="M4 20a8 8 0 0 1 8-8 8 8 0 0 1 8 8"></path>
                        <path d="M16 18h5v-2.5a2.5 2.5 0 0 0-5 0V18z"></path>
                        <path d="M16 15.5V18"></path>
                    </svg>
                </span>
                <span class="user-badge__label">Perfil</span>
                <span class="user-badge__name" sec:authentication="name"></span>
            </div>
        </nav>
    </div>
    <!-- Overlay para fechar menu ao clicar fora - Fora do nav para melhor posicionamento -->
    <div class="menu-overlay" id="menuOverlay" aria-hidden="true"></div>
</header>

<main class="dashboard-wrapper">
    <section class="dashboard-header">
        <h1>GestÃ£o de Alunos</h1>
        <p>Gerencie alunos e boletins acadÃªmicos da sua escola de idiomas.</p>
    </section>

    <section class="dashboard-sections">
        <div class="dashboard-section">
            <div class="dashboard-section__title">
                <h2>Alunos</h2>
                <span>GestÃ£o acadÃªmica</span>
            </div>
            <div class="card-grid">
                <a th:href="@{/alunos/lista}">
                    <div class="card card--featured">
                        <img th:src="@{/img/students-with-laptop-medium-shot.jpg}" alt="Lista de Alunos" />
                        <div class="card-alunos-text">
                            <h2>Lista de Alunos</h2>
                            <p>Visualize, cadastre e gerencie todos os alunos da plataforma.</p>
                        </div>
                    </div>
                </a>
                <a th:href="@{/boletim}">
                    <div class="card card--featured">
                        <img th:src="@{/img/pexels-pixabay-236111.jpg}" alt="Boletins" />
                        <div class="card-turmas-text">
                            <h2>Boletins</h2>
                            <p>Gerencie boletins acadÃªmicos e notas dos alunos.</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </section>
</main>

<footer class="page-footer">
    <div class="footer-content">
        <p class="footer-text">
            Â© <span th:text="${#temporals.format(#temporals.createNow(), 'yyyy')}">2024</span> AriranG - Instituto de Idiomas
        </p>
        <p class="footer-text footer-subtitle">
            Plataforma de gestÃ£o acadÃªmica e administrativa
        </p>
    </div>
</footer>

<script th:inline="javascript">
/* ============================================
   MENU HAMBÃšRGUER - Mobile Navigation
   ============================================ */
document.addEventListener('DOMContentLoaded', function() {
    const menuToggle = document.getElementById('menuToggle');
    const navList = document.getElementById('navList');
    const menuOverlay = document.getElementById('menuOverlay');
    const body = document.body;
    let scrollYBeforeMenu = 0;

    if (!menuToggle || !navList) return;

    function lockPageScroll() {
        scrollYBeforeMenu = window.pageYOffset || document.documentElement.scrollTop || 0;
        body.dataset.scrollYBeforeMenu = String(scrollYBeforeMenu);
        body.style.position = 'fixed';
        body.style.top = `-${scrollYBeforeMenu}px`;
        body.style.left = '0';
        body.style.right = '0';
        body.style.width = '100%';
        body.style.overflow = 'hidden';
    }

    function unlockPageScroll() {
        const y = parseInt(body.dataset.scrollYBeforeMenu || '0', 10) || 0;
        body.style.position = '';
        body.style.top = '';
        body.style.left = '';
        body.style.right = '';
        body.style.width = '';
        body.style.overflow = '';
        delete body.dataset.scrollYBeforeMenu;
        window.scrollTo(0, y);
    }

    // FunÃ§Ã£o para abrir/fechar menu
    function toggleMenu() {
        const isOpen = navList.classList.contains('menu-open');
        
        if (isOpen) {
            closeMenu();
        } else {
            openMenu();
        }
    }

    // FunÃ§Ã£o para abrir menu
    function openMenu() {
        navList.classList.add('menu-open');
        menuToggle.classList.add('active');
        menuToggle.setAttribute('aria-expanded', 'true');
        if (menuOverlay) {
            menuOverlay.classList.add('active');
            menuOverlay.setAttribute('aria-hidden', 'false');
        }
        if (window.innerWidth < 1024) {
            lockPageScroll();
        }
    }

    // FunÃ§Ã£o para fechar menu
    function closeMenu() {
        navList.classList.remove('menu-open');
        menuToggle.classList.remove('active');
        menuToggle.setAttribute('aria-expanded', 'false');
        if (menuOverlay) {
            menuOverlay.classList.remove('active');
            menuOverlay.setAttribute('aria-hidden', 'true');
        }
        unlockPageScroll();
    }

    // Event listener no botÃ£o hambÃºrguer
    menuToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleMenu();
    });

    // Fechar menu ao clicar no overlay
    if (menuOverlay) {
        menuOverlay.addEventListener('click', closeMenu);
    }

    // Fechar menu ao clicar em um link (mobile)
    const navLinks = navList.querySelectorAll('a');
    navLinks.forEach(link => {
        link.addEventListener('click', function() {
            // Fechar menu apenas em mobile (< 1024px)
            if (window.innerWidth < 1024) {
                closeMenu();
            }
        });
    });

    // Fechar menu ao clicar no botÃ£o logout (mobile)
    const logoutButton = navList.querySelector('.logout-button');
    if (logoutButton) {
        logoutButton.addEventListener('click', function() {
            if (window.innerWidth < 1024) {
                closeMenu();
            }
        });
    }

    // Fechar menu ao pressionar ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && navList.classList.contains('menu-open')) {
            closeMenu();
            menuToggle.focus(); // Retorna foco ao botÃ£o
        }
    });

    // Fechar menu ao redimensionar janela (se passar para desktop)
    let resizeTimer;
    window.addEventListener('resize', function() {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function() {
            if (window.innerWidth >= 1024 && navList.classList.contains('menu-open')) {
                closeMenu();
            }
        }, 250);
    });
});
</script>

</body>
</html>